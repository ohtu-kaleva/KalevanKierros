<div class="col-lg-12">
  <h1>Viestijoukkueilmoittautumiset</h1>
<p>Viestijoukkueisiin ilmoittautuneiden lista.</p>
<%= form_tag('/relay_groups', method: :put) do %>
<table id="kk_enrollments" class="table table-striped tablesorter-bootstrap">
  <thead>
    <tr>
      <th>Etunimi</th>
      <th>Sukunimi</th>
      <th>Viestijoukkue</th>
      <th>Viitenumero</th>
      <th>Maksettava</th>
      <th>Maksettu</th>
    </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= user.first_name %></td>
        <td><%= user.last_name %></td>
        <% if user.relay_group.nil? %>
            <td>Ei viestijoukkuetta</td>
        <% else %>
            <td><%= user.relay_group.name %></td>
        <% end %>
        <% if not user.relay_group.nil? and user == user.relay_group.user %>
	    <td><%= user.relay_group.construct_reference_number %></td>
            <td>60</td>
        <% else %>
            <td></td>
            <td></td>
        <% end %>
        <td ><div class="form-group">
          <% if not user.relay_group.nil? and user == user.relay_group.user and user.relay_group.paid.nil? %>
            <%= text_field_tag "paid[#{user.relay_group.id}]", nil, maxlength: 8, :class => "form-control min-width" %>
          <% elsif not user.relay_group.nil? and user == user.relay_group.user and not user.relay_group.paid.nil? %>
            <%= text_field_tag "paid[#{user.relay_group.id}]", user.relay_group.paid/100.0, :class => "form-control min-width"  %>
          <% else %>
            <td></td>
          <% end %>
          </div></td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= submit_tag 'Päivitä maksutiedot', :class => "btn btn-primary" %><br>
<% end %>
<br>
<%= link_to 'Takaisin', admin_kk_enrollment_path, class: 'btn btn-primary' %>
</div>

<script type="text/javascript">
    $(document).ready(function () {
                $.extend($.tablesorter.themes.bootstrap, {
                    // these classes are added to the table. To see other table classes available,
                    // look here: http://twitter.github.com/bootstrap/base-css.html#tables
                    table      : 'table table-bordered',
                    caption    : 'caption',
                    header     : 'bootstrap-header', // give the header a gradient background
                    footerRow  : '',
                    footerCells: '',
                    icons      : '', // add "icon-white" to make them white; this icon class is added to the <i> in the header
                    sortNone   : 'bootstrap-icon-unsorted',
                    sortAsc    : 'icon-chevron-up glyphicon glyphicon-chevron-up',     // includes classes for Bootstrap v2 & v3
                    sortDesc   : 'icon-chevron-down glyphicon glyphicon-chevron-down', // includes classes for Bootstrap v2 & v3
                    active     : '', // applied when column is sorted
                    hover      : '', // use custom css here - bootstrap class may not override it
                    filterRow  : '', // filter row class
                    even       : '', // odd row zebra striping
                    odd        : ''  // even row zebra striping
                });
                $("#relay_groups").tablesorter({
//                    headers: {4: {sorter:false, filter:false} },
                    theme : "bootstrap",
                    headerTemplate : '{content} {icon}',
                    widgets : [ "uitheme", "filter" ],
                })
            }
    );
</script>